{
    "collab_server" : "",
    "contents" : "library(\"S4Vectors\")\nlibrary(\"stats4\")\nlibrary(\"IRanges\")\nlibrary(\"XVector\")\nlibrary(\"Biostrings\")\nlibrary(\"stringr\")\nlibrary(\"RRNA\")\nlibrary(\"ggplot2\")\n\nrm(list=ls())\n\nsetwd(\"/home/ror/Desktop/Mirtrony\")\nsource(\"overhangcount.R\")\nsource(\"mirna_features.R\")\nsource(\"intron_features.R\")\nsource('DataAnalysis_BK.R')\nsource('mirnaplots.R')\n#source('intron_analysis.R')\n#####################################################################################################################################################################\n#MIRTRONS\nmirtron_data=read.csv(\"./Data/mirtrondata.csv\", header=TRUE, stringsAsFactors = FALSE)\nmirna_input1=data.frame(hairpin_seq=mirtron_data$hairpin_seq, db=mirtron_data$dotbracket, fe=mirtron_data$fe, \n                        mature5p_seq=mirtron_data$mature5p_seq, mature3p_seq=mirtron_data$mature3p_seq, stringsAsFactors = FALSE)\nmirtron_mirna=mirna_features(mirna_input1, random=FALSE) #cal, mirna features\nmirtron_mirna$class=1 #1 is for mirtron\nmirtron_mirna$type=mirtron_data$class\n#mirtron_mirna=mirtron_mirna[-c(which(is.na(mirtron_mirna$overhangnumber))),]\n\n#CANONICAL MIRNAs\ncanonical_data=read.csv(\"./Data/canonicaldata.csv\", header=TRUE, stringsAsFactors = FALSE)\nmirna_input2=data.frame(hairpin_seq=canonical_data$hairpin_seq, db=canonical_data$dotbracket, fe=canonical_data$fe, \n                        mature5p_seq=canonical_data$mature5p_seq, mature3p_seq=canonical_data$mature3p_seq, stringsAsFactors = FALSE)\ncanonical_mirna=mirna_features(mirna_input2,random=FALSE)\ncanonical_mirna$class=0\ncanonical_mirna=canonical_mirna[-c(which(is.na(canonical_mirna$overhangnumber))),]\n\n#TEST\ntest_data=read.csv(\"./Data/testdata.csv\", header=TRUE, stringsAsFactors = FALSE)\ntest_input1=data.frame(hairpin_seq=test_data$hairpin_seq, db=test_data$dotbracket, fe=test_data$fe, \n                        mature5p_seq=test_data$mature5p_seq, mature3p_seq=test_data$mature3p_seq, stringsAsFactors = FALSE)\ntest_mirna=mirna_features(test_input1,random=FALSE)\ntest_mirna$class=1 #theoretically mirtrons\n\n\n#RANDOM\nrandom_data=read.csv(\"./Data/randomdata.csv\", header=TRUE, stringsAsFactors = FALSE)\nrandom_input=data.frame(hairpin_seq=\"T\", mature5p_seq=random_data$mature5p_seq, mature3p_seq=random_data$mature3p_seq, stringsAsFactors = FALSE)\n\nrandom_mirna=mirna_features(random_input,random=TRUE)\nrandom_mirna$class=1\n\n\n######################################################################################################\n#Plots\n\nmirtronplots_mirna=mirnaplots(mirtron_mirna)\ncanonicalplots_mirna=mirnaplots(canonical_mirna)\ntestplots_mirna=mirnaplots(test_mirna)\n\n####################################################################################################################################################################\n#PCA\n\n#mirtron vs canonical\nmirtron_mirna=mirtron_mirna[,-21]\nmirtron_mirna=rbind(mirtron_mirna,test_mirna)\npcdata=rbind(mirtron_mirna,canonical_mirna)\npcdata_ml=pcdata\npcdata=pcdata[,-20]\npca=prcomp(pcdata, retx=TRUE, center=TRUE, scale=TRUE)\nlabels=factor(c(rep('mirtron',dim(mirtron_mirna)[1]),rep('canonical',dim(pcdata)[1]-dim(mirtron_mirna)[1])),levels=c('mirtron','canonical'))\ngg2_pca<-BK_gg2_biplot(pca,gr.shape = labels, gr.colour =labels, size=2, attr_text_size=4,\n                       limits = list(x=c(-7,5),y=c(-7,7)))\nplot(gg2_pca) #mirtron vs canonical\n\n#canonical vs test\n#pcdata1=rbind(test_mirna,canonical_mirna)\n#pcdata1=pcdata1[,-20]\n#pca1=prcomp(pcdata1, retx=TRUE, center=TRUE, scale=TRUE)\n#labels1=factor(c(rep('test',dim(test_mirna)[1]),rep('canonical',dim(pcdata1)[1]-dim(test_mirna)[1])),levels=c('test','canonical'))\n#gg2_pca1<-BK_gg2_biplot(pca1,gr.shape = labels, gr.colour =labels, size=2, attr_text_size=4,\n#                       limits = list(x=c(-10,10),y=c(-7,7)))\n#plot(gg2_pca1) #test vs canonical\n\n\n#mirtron vs intron\n#pcdata2=rbind(intron_intron,mirtron_intron)\n#pcdata2=pcdata2[,-dim(pcdata2)[2]]\n#pca2=prcomp(pcdata2, retx=TRUE, center=TRUE, scale=TRUE)\n#summary(pcdata2)\n#labels2=factor(c(rep('mirtron',dim(mirtron_intron)[1]),rep('intron',dim(pcdata2)[1]-dim(mirtron_intron)[1])),\n#               levels=c('mirtron','intron'))\n#gg2_pca2<-BK_gg2_biplot(pca2,gr.shape = labels, gr.colour =labels, size=2, attr_text_size=4,\n#                       limits = list(x=c(-10,10),y=c(-7,7)))\n#plot(gg2_pca2) #mirtron vs intron\n\n\n#mirtron vs random\nmirtron_mirna_rn=mirtron_mirna[,c(names(random_mirna))]\npcdata3=rbind(mirtron_mirna_rn,random_mirna)\npcdata3=pcdata3[,c(-12,-1)]\npca3=prcomp(pcdata3, retx=TRUE, center=TRUE, scale=TRUE)\nlabels=factor(c(rep('mirtron',dim(mirtron_mirna)[1]),rep('random',dim(pcdata3)[1]-dim(mirtron_mirna)[1])),levels=c('mirtron','random'))\ngg2_pca3<-BK_gg2_biplot(pca3,gr.shape = labels, gr.colour =labels, size=2, attr_text_size=4,\n                        limits = list(x=c(-5,6),y=c(-5,5)))\nplot(gg2_pca3) #mirtron vs random\n\n#canonical vs random\ncanonical_mirna_rn=canonical_mirna[,c(names(random_mirna))]\npcdata4=rbind(canonical_mirna_rn,random_mirna)\npcdata4=pcdata4[,c(-12,-1)]\npca4=prcomp(pcdata4, retx=TRUE, center=TRUE, scale=TRUE)\n\nlabels=factor(c(rep('canonical',dim(canonical_mirna)[1]),rep('random',dim(pcdata4)[1]-dim(canonical_mirna)[1])),levels=c('canonical','random'))\ngg2_pca4<-BK_gg2_biplot(pca4,gr.shape = labels, gr.colour =labels, size=2, attr_text_size=4,\n                        limits = list(x=c(-5,6),y=c(-5,5)))\nplot(gg2_pca4) #canonical vs random\n\n\n\n\n\n",
    "created" : 1488969956060.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3933743497",
    "id" : "5EE12C35",
    "lastKnownWriteTime" : 1488973643,
    "last_content_update" : 1488973643962,
    "path" : "~/Desktop/Mirtrony/Main.R",
    "project_path" : "Main.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}